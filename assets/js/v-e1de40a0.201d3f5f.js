"use strict";(self.webpackChunkzerone_docs=self.webpackChunkzerone_docs||[]).push([[439],{9514:(s,n,a)=>{a.r(n),a.d(n,{data:()=>e});const e={key:"v-e1de40a0",path:"/techniques/role.html",title:"Role authorization",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Basic RBAC implementation",slug:"basic-rbac-implementation",children:[]}],filePathRelative:"techniques/role.md",git:{updatedTime:1635918093e3,contributors:[{name:"zzh948498",email:"35091020+zzh948498@users.noreply.github.com",commits:2},{name:"“张智皓”",email:"zhang948498@163.com",commits:1}]}}},972:(s,n,a)=>{a.r(n),a.d(n,{default:()=>p});const e=(0,a(6252).uE)('<h1 id="role-authorization" tabindex="-1"><a class="header-anchor" href="#role-authorization" aria-hidden="true">#</a> Role authorization</h1><p>Authorization refers to the process that determines what a user is able to do. For example, an administrative user is allowed to create, edit, and delete posts. A non-administrative user is only authorized to read the posts.</p><h2 id="basic-rbac-implementation" tabindex="-1"><a class="header-anchor" href="#basic-rbac-implementation" aria-hidden="true">#</a> Basic RBAC implementation</h2><ul><li><strong>Step 1</strong>: Install a simple permission verification package provided by <code>Zerone</code></li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">yarn add @zeronejs/role-easy</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li><strong>Step 2</strong>: let&#39;s create a Role enum representing roles in the system</li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>It is common/role/enums.ts</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">enum</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">Role</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#4FC1FF;">User</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;user&#39;</span><span style="color:#D4D4D4;">,</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#4FC1FF;">Admin</span><span style="color:#D4D4D4;"> = </span><span style="color:#CE9178;">&#39;admin&#39;</span><span style="color:#D4D4D4;">,</span></span>\n<span class="line"><span style="color:#D4D4D4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><strong>Step 3</strong>: Import RolesModule into the root module</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">RolesModule</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@zeronejs/role-easy&#39;</span><span style="color:#D4D4D4;">;</span></span>\n<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#DCDCAA;">Module</span><span style="color:#D4D4D4;">({</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">imports:</span><span style="color:#D4D4D4;"> [</span></span>\n<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#9CDCFE;">RolesModule</span><span style="color:#D4D4D4;">,</span></span>\n<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#6A9955;">// ... Other modules</span></span>\n<span class="line"><span style="color:#D4D4D4;">    ]</span></span>\n<span class="line"><span style="color:#D4D4D4;">})</span></span>\n<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">AppModule</span><span style="color:#D4D4D4;"> {}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><strong>Step 4</strong>: Add the Roles decorator to the interface that requires permission validation</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Roles</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@zeronejs/role-easy&#39;</span><span style="color:#D4D4D4;">;</span></span>\n<span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">Role</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;./common/role/enums&#39;</span><span style="color:#D4D4D4;">;</span></span>\n<span class="line"></span>\n<span class="line"><span style="color:#D4D4D4;">...</span></span>\n<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#DCDCAA;">Get</span><span style="color:#D4D4D4;">()</span></span>\n<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#DCDCAA;">Roles</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">Role</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">Admin</span><span style="color:#D4D4D4;">)</span></span>\n<span class="line"><span style="color:#DCDCAA;">getHello</span><span style="color:#D4D4D4;">(): </span><span style="color:#9CDCFE;">string</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">appService</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">getHello</span><span style="color:#D4D4D4;">();</span></span>\n<span class="line"><span style="color:#D4D4D4;">}</span></span>\n<span class="line"><span style="color:#D4D4D4;">...</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>In this example, we assumed that <code>request.user</code> contains the user instance and allowed roles (under the <code>roles</code> property).</p><p>To make sure this example works, your <code>User</code> class must look as follows:</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">User</span><span style="color:#D4D4D4;"> {</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#6A9955;">// ...other properties</span></span>\n<span class="line"><span style="color:#D4D4D4;">  </span><span style="color:#9CDCFE;">roles</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Role</span><span style="color:#D4D4D4;">[];</span></span>\n<span class="line"><span style="color:#D4D4D4;">}</span></span>\n<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div>',13),l={},p=(0,a(3744).Z)(l,[["render",function(s,n){return e}]])},3744:(s,n)=>{n.Z=(s,n)=>{for(const[a,e]of n)s[a]=e;return s}}}]);