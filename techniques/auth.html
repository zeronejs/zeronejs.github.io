<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/logo/logo.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/logo/logo.png"><link rel="manifest" href="/manifest.webmanifest"><meta name="google-site-verification" content="Nd6zd85AWcaljHfEm5tdOyOmekiVz-MLQvB29STmvV0"><meta name="application-name" content="Zerone"><meta name="apple-mobile-web-app-title" content="Zerone"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png"><link rel="mask-icon" href="/images/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileColor" content="#3eaf7c"><meta name="theme-color" content="#3eaf7c"><title>Authentication | Zerone</title><meta name="description" content="zerone = zero => one, build the Node project from 0 to 1">
    <link rel="preload" href="/assets/js/runtime~app.34489c13.js" as="script"><link rel="preload" href="/assets/css/styles.830cf5e5.css" as="style"><link rel="preload" href="/assets/js/7.db543484.js" as="script"><link rel="preload" href="/assets/js/app.5a9206f9.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.830cf5e5.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">Zerone</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/guide/" class="nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Plugins"><span class="title">Plugins</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Plugins"><span class="title">Plugins</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Plugins</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/techniques/role.html" class="nav-link" aria-label="Role authorization"><!--[--><!--]--> Role authorization <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/techniques/auth.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="Authentication"><!--[--><!--]--> Authentication <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/techniques/redis.html" class="nav-link" aria-label="The cache"><!--[--><!--]--> The cache <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Learn More"><span class="title">Learn More</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Learn More"><span class="title">Learn More</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Resources</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/contributing.html" class="nav-link" aria-label="Contributing Guide"><!--[--><!--]--> Contributing Guide <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/techniques/auth.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/zh/techniques/auth.html" class="nav-link" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/zeronejs/zerone" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/guide/" class="nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Plugins"><span class="title">Plugins</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Plugins"><span class="title">Plugins</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Plugins</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/techniques/role.html" class="nav-link" aria-label="Role authorization"><!--[--><!--]--> Role authorization <!--[--><!--]--></a></li><li class="dropdown-subitem"><a aria-current="page" href="/techniques/auth.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="Authentication"><!--[--><!--]--> Authentication <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/techniques/redis.html" class="nav-link" aria-label="The cache"><!--[--><!--]--> The cache <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Learn More"><span class="title">Learn More</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Learn More"><span class="title">Learn More</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>Resources</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/contributing.html" class="nav-link" aria-label="Contributing Guide"><!--[--><!--]--> Contributing Guide <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/techniques/auth.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/zh/techniques/auth.html" class="nav-link" aria-label="简体中文"><!--[--><!--]--> 简体中文 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/zeronejs/zerone" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Zerone Plugins</p><ul class=""><li><!--[--><a href="/techniques/role.html" class="nav-link sidebar-item" aria-label="Role authorization"><!--[--><!--]--> Role authorization <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/techniques/auth.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Authentication"><!--[--><!--]--> Authentication <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/techniques/auth.html#installation" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Installation"><!--[--><!--]--> Installation <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/techniques/auth.html#start-using" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Start using"><!--[--><!--]--> Start using <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/techniques/auth.html#the-sample" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="The sample"><!--[--><!--]--> The sample <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/techniques/redis.html" class="nav-link sidebar-item" aria-label="The cache"><!--[--><!--]--> The cache <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="authentication" tabindex="-1"><a class="header-anchor" href="#authentication" aria-hidden="true">#</a> Authentication</h1><p>Authentication is an essential part of most applications. There are many different approaches and strategies to handle authentication. The approach taken for any project depends on its particular application requirements. This chapter presents several approaches to authentication that can be adapted to a variety of different requirements.</p><p><a href="https://jwt.io/introduction/" target="_blank" rel="noopener noreferrer">JWT introduction<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2><p>Install an Auth authentication package provided by <code>Zerone</code>, including JWT Strategy and Local Strategy.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">yarn add @zeronejs/auth</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h2 id="start-using" tabindex="-1"><a class="header-anchor" href="#start-using" aria-hidden="true">#</a> Start using</h2><p>Import the AuthModule into the root module.</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>We configure the <code>AuthModule</code> using <code>forRoot()</code>, passing in a configuration object. <a href="https://github.com/auth0/node-jsonwebtoken#usage" target="_blank" rel="noopener noreferrer">here<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> for more details on the available configuration options.</p></div><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">AuthModule</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@zeronejs/auth&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#D4D4D4;">@</span><span style="color:#DCDCAA;">Module</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">imports:</span><span style="color:#D4D4D4;"> [</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#9CDCFE;">AuthModule</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">forRoot</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#9CDCFE;">secret:</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;secretKey&#39;</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#9CDCFE;">signOptions:</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">expiresIn:</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;6h&#39;</span><span style="color:#D4D4D4;"> },</span></span>
<span class="line"><span style="color:#D4D4D4;">        }),</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#6A9955;">// ... Other modules</span></span>
<span class="line"><span style="color:#D4D4D4;">    ]</span></span>
<span class="line"><span style="color:#D4D4D4;">})</span></span>
<span class="line"><span style="color:#C586C0;">export</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">AppModule</span><span style="color:#D4D4D4;"> {}</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="custom-container danger"><p class="custom-container-title">DANGER</p><p>Do not expose this key publicly. We have done so here to make it clear what the code is doing, but in a production system you must protect this key using appropriate measures such as a secrets vault, environment variable, or configuration service.</p></div><p>The JWT Strategy is enabled globally by default. If the interface needs to skip JWT validation, use the decorator <code>@SkipJwtAuth</code></p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">SkipJwtAuth</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">Post</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;auth/register&#39;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#9CDCFE;">async</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">register</span><span style="color:#D4D4D4;">(@</span><span style="color:#DCDCAA;">Body</span><span style="color:#D4D4D4;">() </span><span style="color:#9CDCFE;">createUserDto</span><span style="color:#D4D4D4;">: </span><span style="color:#9CDCFE;">UserCreateDto</span><span style="color:#D4D4D4;">) </span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="the-sample" tabindex="-1"><a class="header-anchor" href="#the-sample" aria-hidden="true">#</a> The sample</h2><p>Typically, you can use this module to implement login registration</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="shiki" style="background-color:#1E1E1E;"><code><span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">UseGuards</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@nestjs/common&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"><span style="color:#C586C0;">import</span><span style="color:#D4D4D4;"> { </span><span style="color:#9CDCFE;">SkipJwtAuth</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">AuthService</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">LocalAuthGuard</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">Request</span><span style="color:#D4D4D4;">, </span><span style="color:#9CDCFE;">encryptedUserPassword</span><span style="color:#D4D4D4;"> } </span><span style="color:#C586C0;">from</span><span style="color:#D4D4D4;"> </span><span style="color:#CE9178;">&#39;@zeronejs/auth&#39;</span><span style="color:#D4D4D4;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#569CD6;">class</span><span style="color:#D4D4D4;"> </span><span style="color:#4EC9B0;">AppController</span><span style="color:#D4D4D4;"> {</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">constructor</span><span style="color:#D4D4D4;">(</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">private</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">readonly</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">userService</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">UserService</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">private</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">readonly</span><span style="color:#D4D4D4;"> </span><span style="color:#9CDCFE;">authService</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">AuthService</span></span>
<span class="line"><span style="color:#D4D4D4;">    ) {}</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">SkipJwtAuth</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">Post</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;auth/register&#39;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">async</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">register</span><span style="color:#D4D4D4;">(@</span><span style="color:#DCDCAA;">Body</span><span style="color:#D4D4D4;">() </span><span style="color:#9CDCFE;">createUserDto</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">UserCreateDto</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#569CD6;">const</span><span style="color:#D4D4D4;"> </span><span style="color:#4FC1FF;">user</span><span style="color:#D4D4D4;"> = </span><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">userService</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">create</span><span style="color:#D4D4D4;">({</span></span>
<span class="line"><span style="color:#D4D4D4;">            ...</span><span style="color:#9CDCFE;">createUserDto</span><span style="color:#D4D4D4;">,</span></span>
<span class="line"><span style="color:#D4D4D4;">            </span><span style="color:#9CDCFE;">password:</span><span style="color:#D4D4D4;"> </span><span style="color:#C586C0;">await</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">encryptedUserPassword</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">createUserDto</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">password</span><span style="color:#D4D4D4;">),</span></span>
<span class="line"><span style="color:#D4D4D4;">        });</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">authService</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">login</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">user</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">SkipJwtAuth</span><span style="color:#D4D4D4;">()</span></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">UseGuards</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">LocalAuthGuard</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    @</span><span style="color:#DCDCAA;">Post</span><span style="color:#D4D4D4;">(</span><span style="color:#CE9178;">&#39;auth/login&#39;</span><span style="color:#D4D4D4;">)</span></span>
<span class="line"><span style="color:#D4D4D4;">    </span><span style="color:#569CD6;">async</span><span style="color:#D4D4D4;"> </span><span style="color:#DCDCAA;">login</span><span style="color:#D4D4D4;">(@</span><span style="color:#DCDCAA;">Req</span><span style="color:#D4D4D4;">() </span><span style="color:#9CDCFE;">req</span><span style="color:#D4D4D4;">: </span><span style="color:#4EC9B0;">Request</span><span style="color:#D4D4D4;">) {</span></span>
<span class="line"><span style="color:#D4D4D4;">        </span><span style="color:#C586C0;">return</span><span style="color:#D4D4D4;"> </span><span style="color:#569CD6;">this</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">authService</span><span style="color:#D4D4D4;">.</span><span style="color:#DCDCAA;">login</span><span style="color:#D4D4D4;">(</span><span style="color:#9CDCFE;">req</span><span style="color:#D4D4D4;">.</span><span style="color:#9CDCFE;">user</span><span style="color:#D4D4D4;">);</span></span>
<span class="line"><span style="color:#D4D4D4;">    }</span></span>
<span class="line"></span></code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>To invoke the <code>login</code> interface(Or when you use <code>LocalAuthGuard</code>), you need to provide the <code>username</code> and <code>passwrod</code> fields.</p></div><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/zeronejs/zeronejs.github.io/blob/main/docs/techniques/auth.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub"><!--[--><!--]--> Edit this page on GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">11/23/2021, 7:35:08 AM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: zhang948498@163.com">“张智皓”</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: 35091020+zzh948498@users.noreply.github.com">zzh948498</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/techniques/role.html" class="nav-link" aria-label="Role authorization"><!--[--><!--]--> Role authorization <!--[--><!--]--></a></span><span class="next"><a href="/techniques/redis.html" class="nav-link" aria-label="The cache"><!--[--><!--]--> The cache <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.34489c13.js" defer></script><script src="/assets/js/7.db543484.js" defer></script><script src="/assets/js/app.5a9206f9.js" defer></script>
  </body>
</html>
